<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Mod Manager</title>
    <link rel="icon" type="image/x-icon" href="../icons/beasts-32-light.png">
    <link rel="stylesheet" href="manager.css">
    <script src="../accents_privileged.js"></script>
  </head>
  <body>
    <template id="modItemTemplate">
      <li class="modItem">
        <div class="infoContainer">
          <div class="modIconContainer">
            <img alt="Mod Icon" class="modIcon" src="placeholder.png">
          </div>
          <div class="modInfo">
            Mod Name
            <br>
            <div class="chipBag">
            </div> 
            <span class="sourceSubtitle">Source</span>
          </div>
        </div>
        <div class="buttonsContainer">
          <a class="gxButton goToStoreButton hidden" href="https://store.gx.me/" target="_blank"><svg width="0" height="17" viewBox="0 0 0 17" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>Store</a>
          <button class="gxButton deleteModButton"><svg width="0" height="17" viewBox="0 0 0 17" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>Delete</button>
        </div>
      </li>
    </template>

    <template id="unzippedMod">
      <div class="modItem" style="padding: 16px;">
        <div class="infoContainer">
          <div class="modIconContainer">
            <img alt="Mod Icon" class="modIcon" src="placeholder.png">
          </div>
          <div class="modInfo">Mod Name<br>
            <div class="chipBag">
            </div> 
            <span class="sourceSubtitle">Version 1.0</span>
          </div>
        </div>
      </div>
    </template>

    <template id="sfxItemTemplate">
      <li class="sfxPreviewItem">
        <span class="sfxName">
          sound_effect.mp3
        </span>
        <div class="rightSideContainer">
          <select id="category-picker">
            <option hidden disabled selected value>- select an option -</option>
            <optgroup label="Browser sounds">
              <option value="CLICK">Click</option>
              <option value="FEATURE_SWITCH_OFF">Switch off</option>
              <option value="FEATURE_SWITCH_ON">Switch on</option>
              <option value="HOVER">Hover</option>
              <option value="HOVER_UP" disabled>Hover up</option>
              <option value="IMPORTANT_CLICK" disabled>Important click</option>
              <option value="LEVEL_UPGRADE">Browser upgrade</option>
              <option value="LIMITER_OFF" disabled>Limiter off</option>
              <option value="LIMITER_ON" disabled>Limiter on</option>
              <option value="SWITCH_TOGGLE">Switch toggle</option>
              <option value="TAB_CLOSE">Tab close</option>
              <option value="TAB_INSERT">Tab insert</option>
              <option value="TAB_SLASH" disabled>Tab slash</option>
            </optgroup>
            <optgroup label="Keyboard sounds">
              <option value="TYPING_BACKSPACE">Backspace</option>
              <option value="TYPING_ENTER">Enter</option>
              <option value="TYPING_SPACE">Spacebar</option>
              <option value="TYPING_LETTER">Keyboard</option>
            </optgroup>
          </select>
        </div>
      </li>
    </template>

    <div class="topToolbar">
      <h2 id="optionsTitle">Manage mods</h2>
    </div>
    <div class="modList">
      <div class="modListTitleContainer">
        <h1 class="modListTitle">Installed</h1>
      </div>
      <div class="card">
        <div class="listHolder">
          <ul id="modListList">
            <li class="emptyState">You have no mods installed.</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="optionContainer buttonsContainer">
      <a class="gxButton" id="goToStore" href="https://store.gx.me/" target="_blank"><svg width="0" height="17" viewBox="0 0 0 17" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>Store</a>
      <button class="gxButton" id="createModButton"><svg width="18" height="17" viewBox="0 0 18 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18 11H17C16.4477 11 16 10.5523 16 10V5.5M18 13H17C16.4477 13 16 13.4477 16 14V15.5C16 16.0523 15.5523 16.5 15 16.5H3C2.44772 16.5 2 16.0523 2 15.5V3.5C2 2.94772 2.44772 2.5 3 2.5H15C15.5523 2.5 16 2.94772 16 3.5V5.5M16 5.5H18" stroke="currentColor"></path><path d="M5 2.5V0.5M9 2.5V0.5M2 14.5H0M2 11.5H0M2 7.5H0M2 4.5H0" stroke="currentColor"></path><rect x="4.5" y="5" width="9" height="9" rx="1.5" stroke="currentColor"></rect><path d="M10 14.5V16.5M7 14.5V16.5M11.5 2.5V4.5" stroke="currentColor"></path><path d="M7 7.5H8.07074L8.97904 9.97656H9.02096L9.92926 7.5H11V11.5H10.1581V9.04297H10.1284L9.269 11.4746H8.731L7.87162 9.0293H7.84192V11.5H7V7.5Z" fill="currentColor"></path></svg>Create</button>
      <button class="gxButton" id="importModButton"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-file-archive"><path d="M10 12v-1"/><path d="M10 18v-2"/><path d="M10 7V6"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/><path d="M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01"/><circle cx="10" cy="20" r="2"/></svg>Import</button>
    </div>

    <div id="createModModal" class="modal hidden">
      <div class="modalContent">
        <div class="modalContainer">
          <h1>Create new mod</h1>
          <hr>
          <hr class="spacer">
          <label for="modname">Mod name<input type="text" id="modname" name="modname"></label>
          <hr class="spacer">
          <span class="titleMsg" id="iconTitle">
            Mod icon<br><hr class="spacer">
            <label for="icon" id="iconButton" class="modIconContainer">
              <img alt="Mod Icon" class="modIcon" src="placeholder.png">
              <div class="iconButtonOverlay"></div>
              <input type="file" id="icon" name="icon" accept="image/*" multiple>
            </label>
          </span>
          
          <span class="subtitle">Optional. Accepts any image file. Max files: 1.</span>
          <hr class="spacer">
          <hr>
          <hr class="spacer">
          <span class="titleMsg" id="filesTitle">Background music<br><label for="files" id="filesButton">Choose files<input type="file" id="files" name="files" accept=".mp3, .wav, .ogg, .opus" multiple></label></span>
          <span class="subtitle">Accepted file types: mp3, ogg, wav. Max files: 7.<br>Select multiple files to add layers. Each layer will be played in ascending order.</span>
          <br>
          <span class="subtitle">Ensure that all files are the exact same length, or they will desync over time.</span>
          <hr class="spacer">
          <hr>
          <div class="preview">
            <span class="emptyState">No files currently selected</span>
          </div>
          <hr>
          <hr class="spacer">
          <span class="subtitle invalidItem hidden" id="lengthDifference">Some layers have different lengths! This will cause desyncs sooner or later!<br><br></span>

          <span class="titleMsg" id="sfxTitle">Sound effects<br><label for="sfx" id="sfxFilesButton">Choose files<input type="file" id="sfx" name="sfx" accept=".mp3, .wav, .ogg, .opus" multiple></label></span>
          <span class="subtitle">Accepted file types: mp3, ogg, wav.</span>
          <br>
          <span class="subtitle">No limit on max files, but every file must have a category set.</span>
          <hr class="spacer">
          <hr class="sfxHr">
          <div class="sfxPreview">
            <span class="emptyState">No files currently selected</span>
          </div>
          <hr>
          <span class="subtitle hidden" id="longSfx">Long sound effects might eat up RAM quickly. Consider cutting them down to 10 seconds or less.<br><br></span>

          <div class="buttonsContainer">
            <span class="subtitle invalidItem hidden" id="errorMessage">Something went wrong, please try again.</span>
            <button class="gxButton" id="cancel" draggable="false"><svg width="0" height="17" viewBox="0 0 0 17" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>Cancel</button>
            <button class="gxButton finishButton" id="finish" disabled><svg width="0" height="17" viewBox="0 0 0 17" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>Create</button>
          </div>
        </div>
      </div>
    </div>

    <div id="importModModal" class="modal hidden">
      <div class="modalContent">
        <div class="modalContainer">
          <h1>Import mod from archive</h1>
          <hr>
          <span class="titleMsg" id="zipTitle">Zip archive<br><label for="zip" id="zipButton">Choose file<input type="file" id="zip" name="zip" accept=".zip"></label></span>
          <hr>
          <div class="zipPreview">
            <span class="emptyState">No files currently selected</span>
          </div>
          <hr>

          <div class="buttonsContainer">
            <span class="subtitle invalidItem hidden" id="errorMessage_import">Something went wrong, please try again.</span>
            <button class="gxButton" id="cancel_import" draggable="false">Cancel</button>
            <button class="gxButton finishButton" id="finish_import" disabled>Add mod</button>
          </div>
        </div>
      </div>
    </div>

    <div id="debugModal" class="modal hidden">
      <div class="modalContent">
        <div class="modalContainer">
          <h1>Debug options</h1>
          <hr>
          <span class="subtitle">These options are for diagnosing problems with GXM, and will not persist through restarts.</span>
          <div class="optionContainer switchContainer">
            <label for="enableSoundLogs">Log keyboard sound events during this session</label>
            <label class="switch">
              <input id="enableSoundLogs" type="checkbox">
              <span class="toggleSwitch round"></span>
            </label>
          </div>
          <span class="subtitle">Only the last 128 events will be logged.</span><br>
          <hr class="spacer">
          <button class="gxButton" id="export_log" draggable="false" disabled>Export log to file</button>
          <button class="gxButton" id="empty_log" draggable="false" disabled>Clear logs</button>
          <br>
          <hr class="spacer">
          <hr>
          <div class="buttonsContainer">
            <button class="gxButton" id="cancel_debug" draggable="false">Close</button>
          </div>
        </div>
      </div>
    </div>

    <footer>
      <a id="footerLink" href="#">GX Mods...</a>
    </footer> 

    <script src="../libs/localforage.min.js"></script>
    <script src="../libs/zip-no-worker-inflate.min.js"></script>
    <script src="manager.js"></script>
    <script src="../content_scripts/gx_music.js"></script>
  </body>
</html>